<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siemens "Run My Screens" graphics simulator</title>
    <link rel="stylesheet" href="CSS/main.css">
</head>
<body>
    <div id="statusIndicator" class="status-indicator">Settings Auto-Saved ✓</div>
    
    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="closeSidebar()"></div>
    
    <!-- Collapsible Sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-content">
            <h3>Canvas Settings</h3>
            
            <div class="control-group">
                <label for="canvasWidth">Canvas Width:</label>
                <input type="number" id="canvasWidth" value="600" min="100" max="1000" step="1">
            </div>
            
            <div class="control-group">
                <label for="canvasHeight">Canvas Height:</label>
                <input type="number" id="canvasHeight" value="400" min="100" max="800" step="1">
            </div>
            
            <div class="control-group">
                <label for="backgroundColor">Background Color:</label>
                <input type="color" id="backgroundColor" value="#ffffff">
            </div>
            
            <h3>Canvas Actions</h3>
            
            <div class="control-group">
                <button onclick="updateCanvas()">Refresh Canvas</button>
                <button onclick="clearCanvas()">Clear Canvas</button>
                <button onclick="screenshotCanvasPng()">Screenshot Canvas to png</button>
            </div>
            
            <div class="control-group">
                <button onclick="downloadShapeList()">Download Shape List (.com.txt)</button>
            </div>
            
            <div class="control-group">
                <button onclick="clearSavedState(); location.reload();" style="background-color: #dc3545; margin-top: 10px;">Reset All Settings</button>
            </div>
        </div>
    </div>
    
    <!-- Sidebar Toggle Tab -->
    <div id="sidebarTab" class="sidebar-tab" onclick="toggleSidebar()">
        <span>⚙️</span>
    </div>
    
    <div class="main-layout" id="mainLayout">
        <!-- Draggable Panel 1: Canvas -->
        <div class="panel" id="canvasPanel" data-panel="canvas">
            <div class="panel-header" draggable="true">
                <span class="panel-title">Canvas</span>
                <span class="drag-handle">⋮⋮</span>
            </div>
            <div class="panel-content">
                <div class="canvas-toolbar">
                    <button id="undoBtn" onclick="undo()" title="Undo (Ctrl+Z)" disabled>↶ Undo</button>
                    <button id="redoBtn" onclick="redo()" title="Redo (Ctrl+Y)" disabled>↷ Redo</button>
                </div>
                <div class="canvas-container">
                    <canvas id="myCanvas" width="600" height="400"></canvas>
                </div>
                <div class="graphic-logic-section">
                    <h4 class="graphic-logic-title">Graphic Logic</h4>
                    <div class="graphic-logic-container">
                        <textarea id="graphicLogicText" class="graphic-logic-textarea" placeholder="Enter graphic logic code here..." rows="6"></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Draggable Panel 2: Shape List -->
        <div class="panel" id="shapeListPanel" data-panel="shapelist">
            <div class="panel-header" draggable="true">
                <span class="panel-title">Shape List</span>
                <span class="drag-handle">⋮⋮</span>
            </div>
            <div class="panel-content">
                <div class="shapes-list-container">
                    <div class="control-group">
                        <div id="shapesList" class="shapes-list"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Draggable Panel 3: Properties -->
        <div class="panel" id="propertiesPanel" data-panel="properties">
            <div class="panel-header" draggable="true">
                <span class="panel-title">Properties</span>
                <span class="drag-handle">⋮⋮</span>
            </div>
            <div class="panel-content">
                <div class="controls-container">
                    <div class="control-group">
                        <button onclick="addShape()" style="background-color: #28a745; margin-bottom: 15px;">+ Add New Shape</button>
                    </div>
                    
                    <div class="control-group">
                        <label for="shapeType">Shape Type:</label>
                        <select id="shapeType">
                            <option value="def">DEF</option>
                            <option value="ellipse">Ellipse</option>
                            <option value="rectangle">Rectangle</option>
                            <option value="line">Line</option>
                            <option value="v_separator">V Separator</option>
                            <option value="h_separator">H Separator</option>
                        </select>
                    </div>
                    
                    <!-- DEF properties -->
                    <div class="control-group def-only">
                        <label for="defVariableName">Variable Name:</label>
                        <input type="text" id="defVariableName" value="" placeholder="Enter variable name...">
                    </div>
                    
                    <div class="control-group def-only">
                        <label for="defVariableType">Variable Type:</label>
                        <select id="defVariableType">
                            <optgroup label="REAL">
                                <option value="R">R - REAL</option>
                                <option value="R[0]">R[0] - REAL (0 decimal places)</option>
                                <option value="R[1]">R[1] - REAL (1 decimal place)</option>
                                <option value="R[2]">R[2] - REAL (2 decimal places)</option>
                                <option value="R[3]">R[3] - REAL (3 decimal places)</option>
                                <option value="R[4]">R[4] - REAL (4 decimal places)</option>
                                <option value="R[5]">R[5] - REAL (5 decimal places)</option>
                            </optgroup>
                            <optgroup label="INTEGER">
                                <option value="I">I - INTEGER (32 bits decimal signed)</option>
                                <option value="IB">IB - INTEGER (32 bits binary)</option>
                                <option value="IBD">IBD - INTEGER (32 bits binary)</option>
                                <option value="IBW">IBW - INTEGER (16 bits binary)</option>
                                <option value="IBB">IBB - INTEGER (8 bits binary)</option>
                                <option value="IDD">IDD - INTEGER (32 bits decimal signed)</option>
                                <option value="IDW">IDW - INTEGER (16 bits decimal signed)</option>
                                <option value="IDB">IDB - INTEGER (8 bits decimal signed)</option>
                                <option value="IDDU">IDDU - INTEGER (32 bits decimal unsigned)</option>
                                <option value="IDWU">IDWU - INTEGER (16 bits decimal unsigned)</option>
                                <option value="IDBU">IDBU - INTEGER (8 bits decimal unsigned)</option>
                                <option value="IH">IH - INTEGER (32 bits hexadecimal)</option>
                                <option value="IHDU">IHDU - INTEGER (32 bits hexadecimal)</option>
                                <option value="IHWU">IHWU - INTEGER (16 bits hexadecimal)</option>
                                <option value="IHBU">IHBU - INTEGER (8 bits hexadecimal)</option>
                            </optgroup>
                            <optgroup label="STRING">
                                <option value="S">S - STRING</option>
                                <option value="S[1]">S[1] - STRING (1 character)</option>
                                <option value="S[10]">S[10] - STRING (10 characters)</option>
                                <option value="S[20]">S[20] - STRING (20 characters)</option>
                                <option value="S[50]">S[50] - STRING (50 characters)</option>
                                <option value="S[100]">S[100] - STRING (100 characters)</option>
                                <option value="S[255]">S[255] - STRING (255 characters)</option>
                            </optgroup>
                            <optgroup label="OTHER">
                                <option value="C">C - CHARACTER</option>
                                <option value="B">B - BOOL</option>
                                <option value="V">V - VARIANT</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="control-group def-only" id="defLimitsGroup">
                        <label for="defLimits">Limits (MIN,MAX):</label>
                        <input type="text" id="defLimits" value="" placeholder='e.g. 0,100 or "A","F"'>
                        <small class="help-text">For types I, C, R only. Use decimal values or characters like "A","F"</small>
                    </div>
                    
                    <div class="control-group def-only">
                        <label for="defDefaultValue">Default Value:</label>
                        <input type="text" id="defDefaultValue" value="" placeholder="Enter default value (optional)">
                        <small class="help-text">If empty and no toggle field defined, status is "not calculated"</small>
                    </div>
                    
                    <div class="control-group def-only">
                        <label for="defToggle">Toggle:</label>
                        <input type="text" id="defToggle" value="" placeholder='e.g. * 0,1,2,3 or * "On","Off" or * 1="On",0="Off"'>
                        <small class="help-text">List with predetermined entries. Starts with * and entries separated by commas</small>
                    </div>
                    
                    <!-- Position and size properties (x,y,w,h) -->
                    <div class="control-group control-row ellipse-rectangle-only">
                        <div class="control-half">
                            <label for="positionX" id="positionXLabel">X Position:</label>
                            <input type="number" id="positionX" value="300" min="0" max="600" step="1">
                        </div>
                        <div class="control-half">
                            <label for="positionY" id="positionYLabel">Y Position:</label>
                            <input type="number" id="positionY" value="200" min="0" max="400" step="1">
                        </div>
                    </div>
                    
                    <div class="control-group control-row ellipse-rectangle-only">
                        <div class="control-half">
                            <label for="shapeWidth">Width (w):</label>
                            <input type="number" id="shapeWidth" value="50" min="8" max="500" step="1">
                        </div>
                        <div class="control-half">
                            <label for="shapeHeight">Height (h):</label>
                            <input type="number" id="shapeHeight" value="50" min="8" max="500" step="1">
                        </div>
                    </div>
                    
                    <!-- Color properties (f1,f2) -->
                    <div class="control-group ellipse-rectangle-only line-only">
                        <label for="borderColor">Border Color (f1):</label>
                        <input type="color" id="borderColor" value="#000000">
                    </div>
                    
                    <div class="control-group ellipse-rectangle-only">
                        <label for="fillColor">Fill Color (f2):</label>
                        <input type="color" id="fillColor" value="#ff0000">
                    </div>
                    
                    <!-- Style property (s) -->
                    <div class="control-group ellipse-rectangle-only line-only">
                        <label for="borderStyle">Border Style:</label>
                        <select id="borderStyle">
                            <option value="1">Solid</option>
                            <option value="2">Dashed</option>
                            <option value="3">Dotted</option>
                            <option value="4">Dashed and Dotted</option>
                        </select>
                    </div>
                    
                    <!-- Tag and visibility properties -->
                    <div class="control-group ellipse-rectangle-only">
                        <label for="shapeTag">Tag:</label>
                        <input type="text" id="shapeTag" value="" placeholder="Enter tag...">
                    </div>
                    
                    <div class="control-group ellipse-rectangle-only">
                        <label for="shapeVisible">Visible:</label>
                        <button type="button" id="shapeVisible" class="toggle-button" data-value="true">TRUE</button>
                    </div>
                    
                    <!-- Line properties -->
                    <div class="control-group control-row line-only">
                        <div class="control-half">
                            <label for="lineX1">Start X:</label>
                            <input type="number" id="lineX1" value="50" min="0" max="600" step="1">
                        </div>
                        <div class="control-half">
                            <label for="lineY1">Start Y:</label>
                            <input type="number" id="lineY1" value="50" min="0" max="400" step="1">
                        </div>
                    </div>
                    
                    <div class="control-group control-row line-only">
                        <div class="control-half">
                            <label for="lineX2">End X:</label>
                            <input type="number" id="lineX2" value="150" min="0" max="600" step="1">
                        </div>
                        <div class="control-half">
                            <label for="lineY2">End Y:</label>
                            <input type="number" id="lineY2" value="150" min="0" max="400" step="1">
                        </div>
                    </div>
                    
                    <!-- Line tag property -->
                    <div class="control-group line-only">
                        <label for="lineTag">Tag:</label>
                        <input type="text" id="lineTag" value="" placeholder="Enter tag...">
                    </div>
                    
                    <!-- Line visibility property -->
                    <div class="control-group line-only">
                        <label for="lineVisible">Visible:</label>
                        <button type="button" id="lineVisible" class="toggle-button" data-value="true">TRUE</button>
                    </div>
                    
                    <!-- V_SEPARATOR properties -->
                    <div class="control-group v-separator-only">
                        <label for="vSepX">X Position:</label>
                        <input type="number" id="vSepX" value="300" min="0" max="600" step="1">
                    </div>
                    
                    <div class="control-group v-separator-only">
                        <label for="vSepWidth">Line Weight (w):</label>
                        <input type="number" id="vSepWidth" value="2" min="1" max="20" step="1">
                    </div>
                    
                    <div class="control-group v-separator-only">
                        <label for="vSepColor">Color:</label>
                        <input type="color" id="vSepColor" value="#000000">
                    </div>
                    
                    <div class="control-group v-separator-only">
                        <label for="vSepPen">Pen Style:</label>
                        <select id="vSepPen">
                            <option value="1">Solid</option>
                            <option value="2">Dashed</option>
                            <option value="3">Dotted</option>
                            <option value="4">Dashed and Dotted</option>
                        </select>
                    </div>
                    
                    <!-- V_SEPARATOR tag property -->
                    <div class="control-group v-separator-only">
                        <label for="vSepTag">Tag:</label>
                        <input type="text" id="vSepTag" value="" placeholder="Enter tag...">
                    </div>
                    
                    <!-- V_SEPARATOR visibility property -->
                    <div class="control-group v-separator-only">
                        <label for="vSepVisible">Visible:</label>
                        <button type="button" id="vSepVisible" class="toggle-button" data-value="true">TRUE</button>
                    </div>
                    
                    <!-- H_SEPARATOR properties -->
                    <div class="control-group control-row h-separator-only">
                        <div class="control-half">
                            <label for="hSepY">Y Position:</label>
                            <input type="number" id="hSepY" value="200" min="0" max="400" step="1">
                        </div>
                        <div class="control-half">
                            <label for="hSepHeight">Line Weight (h):</label>
                            <input type="number" id="hSepHeight" value="2" min="1" max="20" step="1">
                        </div>
                    </div>
                    
                    <div class="control-group h-separator-only">
                        <label for="hSepColor">Color:</label>
                        <input type="color" id="hSepColor" value="#000000">
                    </div>
                    
                    <div class="control-group h-separator-only">
                        <label for="hSepPen">Pen Style:</label>
                        <select id="hSepPen">
                            <option value="1">Solid</option>
                            <option value="2">Dashed</option>
                            <option value="3">Dotted</option>
                            <option value="4">Dashed and Dotted</option>
                        </select>
                    </div>
                    
                    <!-- H_SEPARATOR tag property -->
                    <div class="control-group h-separator-only">
                        <label for="hSepTag">Tag:</label>
                        <input type="text" id="hSepTag" value="" placeholder="Enter tag...">
                    </div>
                    
                    <!-- H_SEPARATOR visibility property -->
                    <div class="control-group h-separator-only">
                        <label for="hSepVisible">Visible:</label>
                        <button type="button" id="hSepVisible" class="toggle-button" data-value="true">TRUE</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load JavaScript modules in dependency order -->
    <!-- Core modules first -->
    <script src="JS/constants.js"></script>
    <script src="JS/appState.js"></script>
    
    <!-- Utility functions -->
    <script src="JS/utils.js"></script>
    
    <!-- Feature modules -->
    <script src="JS/canvasDrawing.js"></script>
    <script src="JS/shapeOperations.js"></script>
    <script src="JS/storage.js"></script>
    <script src="JS/uiControls.js"></script>
    <script src="JS/undoRedo.js"></script>
    <script src="JS/dragDrop.js"></script>
    <script src="JS/eventHandlers.js"></script>
    
    <!-- Main initialization (must be last) -->
    <script src="JS/main.js"></script>
</body>
</html>